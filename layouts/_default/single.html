{{ define "main" }}

<article>
    {{ partial "nav-logo.html" }}
    {{ partial "nav-socials.html" }}

    <header>        
        {{ $featured_img := .Scratch.Get "featured_img" }}
        {{ $featured_color := (index $featured_img.Colors 1) }}
        {{ $featured_color_2 := (index $featured_img.Colors 2) }}
        {{ $featured_color_rgb := partial "hextorgb.html" $featured_color | print | safeCSS }}
        {{ $featured_color_rgb_2 := partial "hextorgb.html" $featured_color_2 | print | safeCSS }}
        <div id="featured-image" style="background-image: url('{{ $featured_img.RelPermalink }}')"></div>

        {{ partial "grid.html" . }}

        <div id="header-shadow"></div>

        {{ partial "cube.html" "cube1" }}
        {{ partial "cube.html" "cube2" }}
        <!-- Apply post featured color to grid and cube --> 
        <style>            
            .grid-lines {
                background-image: linear-gradient(to right, {{ $featured_color_2 }} 2px, transparent 0), 
                linear-gradient(to bottom, {{ $featured_color_2 }} 2px, transparent 0);
            }

            #cube1, #cube2 {
                .cube-side {
                    border: 1px solid rgba({{ $featured_color_rgb_2 }}, 0.4 );
                    background-color: rgba({{ $featured_color_rgb }}, 0.8 );
                    box-shadow: rgba({{ $featured_color_rgb }}, 1 ) 0px 0px 100px 15px;
                }
            }
            #cube1 {
                top: 128px;
                left: 20%;
            }
            #cube2 {
                top: 256px;
                right: 20%;
            }

            strong {
                color: color-mix(in srgb, {{ $featured_color }} 50%, white);
            }

            blockquote {
                border-left: color-mix(in srgb, {{ $featured_color }} 50%, white) 16px solid;
            }
        </style>

        <div class="content-wrapper-wide">
            <time style="color: color-mix(in srgb, {{ $featured_color }} 50%, white)">{{ .Date.Format "Mon Jan 2, 2006" }}</time>
            <h1 style="-webkit-text-stroke: 2px color-mix(in srgb, {{ $featured_color }} 50%, white)">{{ .Title }}</h1>
            <ul class="post-tags">
                {{- with .Params.tags -}}
                {{- if ge (len .) 1 -}}
                {{- range . -}}
                <li style="background-color: rgba({{ $featured_color_rgb_2 }}, 1)" class="post-tag">{{ . }}</li>
                {{ end -}}
                {{- end -}}
                {{- end -}}
            </ul>
            <p style="color: color-mix(in srgb, {{ $featured_color_2 }} 35%, white)">{{ .Description }}</p>
        </div>
    </header>

    <div style="width: 100%; height: 128px; box-shadow: 0 -128px 64px 64px rgba({{ $featured_color_rgb }}, 0.5); position: absolute;"></div>

    <div class="content-wrapper">
        {{ .Content }}
    </div>
</article>

{{ end }}