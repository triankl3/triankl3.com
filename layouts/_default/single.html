{{ define "main" }}

<article>
    <header>        
        {{ $featured_img := .Scratch.Get "featured_img" }}
        {{ $featured_color := (index $featured_img.Colors 1) }}
        {{ $featured_color_2 := (index $featured_img.Colors 2) }}
        {{ $featured_color_rgb := partial "func-hextorgb.html" $featured_color | print | safeCSS }}
        {{ $featured_color_rgb_2 := partial "func-hextorgb.html" $featured_color_2 | print | safeCSS }}
        <div id="featured-image" style="background-image: url('{{ $featured_img.RelPermalink }}')"></div>

        <div id="header-shadow"></div>
        
        {{ partial "effect-cube.html" "cube1" }}
        {{ partial "effect-cube.html" "cube2" }}
        <style>            
            .effect-grid-container {
                position: absolute;
                width: 100%;
            }
            .effect-grid-lines {
                background-image: linear-gradient(to right, {{ $featured_color_2 }} 1px, transparent 0), 
                linear-gradient(to bottom, {{ $featured_color_2 }} 1px, transparent 0) !important;
            }

            #cube1, #cube2 {
                .effect-cube-side {
                    border: 1px solid rgba({{ $featured_color_rgb_2 }}, 0.4 );
                    background-color: rgba({{ $featured_color_rgb }}, 0.8 );
                    box-shadow: rgba({{ $featured_color_rgb }}, 0.8 ) 0 0 128px 0;
                }
            }
            #cube1 {
                top: 128px;
                left: 20%;
            }
            #cube2 {
                top: 256px;
                right: 20%;
            }

            #effect-gradient {
                display: none;
            }
        </style>

        <div class="content-wrapper-max">
            <h2 style="color: color-mix(in srgb, {{ $featured_color }} 50%, white)">{{ .Date.Format "Jan 2, 2006" }} // {{ .Section }}</h2>
            <h1 style="color: color-mix(in srgb, {{ $featured_color }} 50%, white)">{{ .Title }}</h1>
            <p style="color: color-mix(in srgb, {{ $featured_color_2 }} 35%, white)">{{ .Description }}</p>
            <ul class="post-tags">
                {{ with .Params.tags }}
                {{ if ge (len .) 1 }}
                {{ range . }}
                <li class="post-tag" style="background-color: color-mix(in srgb, {{ $featured_color }} 50%, black)">{{ . }}</li>
                {{ end }}
                {{ end }}
                {{ end }}
            </ul>
        </div>

        {{/*  Header bottom gradient shadow  */}}
        <div style="width: 100%; height: 128px; box-shadow: 0 -128px 64px 64px rgba({{ $featured_color_rgb }}, 0.5); position: absolute;"></div>
    </header>

    {{ .Content }}
</article>

{{ end }}